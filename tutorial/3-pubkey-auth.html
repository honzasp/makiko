<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/makiko/assets/css/just-the-docs-default.css"> <script src="/makiko/assets/js/vendor/lunr.min.js"></script> <script src="/makiko/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <link rel="icon" href="/makiko/favicon.ico" type="image/x-icon"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Public key authentication | Makiko</title> <meta name="generator" content="Jekyll v4.3.0" /> <meta property="og:title" content="Public key authentication" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Makiko is an asynchronous SSH client library in pure Rust" /> <meta property="og:description" content="Makiko is an asynchronous SSH client library in pure Rust" /> <link rel="canonical" href="https://honzasp.github.io/makiko/makiko/tutorial/3-pubkey-auth.html" /> <meta property="og:url" content="https://honzasp.github.io/makiko/makiko/tutorial/3-pubkey-auth.html" /> <meta property="og:site_name" content="Makiko" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Public key authentication" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Makiko is an asynchronous SSH client library in pure Rust","headline":"Public key authentication","url":"https://honzasp.github.io/makiko/makiko/tutorial/3-pubkey-auth.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Feather. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/makiko/" class="site-title lh-tight"> Makiko </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/makiko/" class="nav-list-link">Home</a></li><li class="nav-list-item active"><a href="#" class="nav-list-expander" aria-label="toggle links in Tutorial category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/makiko/tutorial/" class="nav-list-link">Tutorial</a><ul class="nav-list "><li class="nav-list-item "><a href="/makiko/tutorial/1-connect.html" class="nav-list-link">Connecting to the server</a></li><li class="nav-list-item "><a href="/makiko/tutorial/2-password-auth.html" class="nav-list-link">Password authentication</a></li><li class="nav-list-item active"><a href="/makiko/tutorial/3-pubkey-auth.html" class="nav-list-link active">Public key authentication</a></li><li class="nav-list-item "><a href="/makiko/tutorial/4-pubkey-algo.html" class="nav-list-link">Public key algorithm</a></li><li class="nav-list-item "><a href="/makiko/tutorial/5-execute-command.html" class="nav-list-link">Execute a command</a></li><li class="nav-list-item "><a href="/makiko/tutorial/6-open-tunnel.html" class="nav-list-link">Open a tunnel</a></li><li class="nav-list-item "><a href="/makiko/tutorial/7-verify-pubkey.html" class="nav-list-link">Verify the server key</a></li></ul></li></ul> <ul class="nav-list"><li class="nav-list-item external"> <a href="https://github.com/honzasp/makiko" class="nav-list-link external"> Makiko on Github <svg viewBox="0 0 24 24" aria-labelledby="svg-external-link-title"><use xlink:href="#svg-external-link"></use></svg> </a> </li><li class="nav-list-item external"> <a href="https://docs.rs/makiko/latest/makiko" class="nav-list-link external"> API documentation <svg viewBox="0 0 24 24" aria-labelledby="svg-external-link-title"><use xlink:href="#svg-external-link"></use></svg> </a> </li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Makiko" aria-label="Search Makiko" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://github.com/honzasp/makiko" class="site-button" > Github </a> </li> <li class="aux-nav-list-item"> <a href="https://docs.rs/makiko/latest/makiko" class="site-button" > API docs </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/makiko/tutorial/">Tutorial</a></li> <li class="breadcrumb-nav-list-item"><span>Public key authentication</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 id="public-key-authentication"> <a href="#public-key-authentication" class="anchor-heading" aria-labelledby="public-key-authentication"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Public key authentication </h1> <p>In this chapter, we will authenticate to the SSH server using a private key. With this authentication method, we send a public key to the server and we cryptographically prove that we own the corresponding private key. However, our private key is not transmitted, so it stays secure even if we connect to an untrusted server. The server then decides whether to accept the public key, for example by consulting a list of public keys stored in the <a href="https://man.openbsd.org/sshd#AUTHORIZED_KEYS_FILE_FORMAT"><code class="language-plaintext highlighter-rouge">~/.ssh/authorized_keys</code></a> file on the server.</p> <h2 id="get-the-private-key"> <a href="#get-the-private-key" class="anchor-heading" aria-labelledby="get-the-private-key"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Get the private key </h2> <p>Makiko supports several types of public/private keys:</p> <ul> <li><a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)">RSA</a> is the original public key cryptosystem based on integer factorization, which is still widely deployed. The theoretical algorithm is sound, but practical implementations of RSA have a long history of being subtly flawed, so using RSA is <a href="https://blog.trailofbits.com/2019/07/08/fuck-rsa/">discouraged</a>.</li> <li><a href="https://en.wikipedia.org/wiki/Elliptic-curve_cryptography">Elliptic curve cryptography</a> is a more modern class of public key algorithms that are based on elliptic curves. Makiko supports: <ul> <li><a href="https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm">ECDSA</a> is a standardized signature algorithm scheme based on elliptic curves. Makiko supports ECDSA with two curves, NIST P-256 and NIST P-384. However, there have been suspicions that these curves may contain a backdoor, because they are generated using parameters that have not been fully explained.</li> <li><a href="https://en.wikipedia.org/wiki/EdDSA">EdDSA</a> is a different signature algorithm scheme. Makiko supports the algorithm <a href="https://ed25519.cr.yp.to/">Ed25519</a>, which uses <a href="https://cr.yp.to/ecdh.html">Curve25519</a>. This algorithm is fast and is considered very secure.</li> </ul> </li> </ul> <p>In Makiko, public keys are represented as the enum <a href="https://docs.rs/makiko/latest/makiko/pubkey/enum.Pubkey.html"><code class="language-plaintext highlighter-rouge">Pubkey</code></a> and private keys as the enum <a href="https://docs.rs/makiko/latest/makiko/pubkey/enum.Privkey.html"><code class="language-plaintext highlighter-rouge">Privkey</code></a>. You can always obtain the public key from the private key by calling <a href="https://docs.rs/makiko/latest/makiko/pubkey/enum.Privkey.html#method.pubkey"><code class="language-plaintext highlighter-rouge">Privkey::pubkey()</code></a>.</p> <h3 id="file-formats-for-private-keys"> <a href="#file-formats-for-private-keys" class="anchor-heading" aria-labelledby="file-formats-for-private-keys"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> File formats for private keys </h3> <p>To authenticate with public key authentication, we need to obtain the private key. Makiko can read private keys in the following formats:</p> <ul> <li>PKCS#1: Legacy format for RSA keys, uses <a href="https://en.wikipedia.org/wiki/ASN.1">ASN.1</a> and encodes the key using the <a href="https://en.wikipedia.org/wiki/X.690#DER_encoding">DER</a> encoding.</li> <li>PKCS#8: A newer format that can encode keys from different public key algorithms. This format is common when working with TLS and other cryptography applications. It is also based on ASN.1 and uses DER encoding.</li> <li>OpenSSH: A format for private keys that is used by OpenSSH. The key is not encoded using DER but with the same encoding that is used in the SSH protocol.</li> </ul> <p>Private keys in these formats may also be encrypted. Makiko supports decrypting private keys in PKCS#8 and OpenSSH formats; encrypted keys in the PKCS#1 format are not supported.</p> <p>All these formats are binary. To make them easier to use, they are usually stored in <a href="https://en.wikipedia.org/wiki/Privacy-Enhanced_Mail">PEM</a> format, which encodes the binary data in a textual form. PEM files can be easily recognized by starting with <code class="language-plaintext highlighter-rouge">-----BEGIN &lt;tag&gt;-----</code>, followed by base64-encoded data and ending with <code class="language-plaintext highlighter-rouge">-----END &lt;tag&gt;-----</code>, where <code class="language-plaintext highlighter-rouge">&lt;tag&gt;</code> is a string that determines the format of the binary data:</p> <ul> <li><code class="language-plaintext highlighter-rouge">-----BEGIN PRIVATE KEY-----</code> is a private key in PKCS#8 format,</li> <li><code class="language-plaintext highlighter-rouge">-----BEGIN RSA PRIVATE KEY-----</code> is a private key in PKCS#1 format,</li> <li><code class="language-plaintext highlighter-rouge">-----BEGIN OPENSSH PRIVATE KEY-----</code> is a private key in OpenSSH format, and</li> <li><code class="language-plaintext highlighter-rouge">-----BEGIN ENCRYPTED PRIVATE KEY-----</code> is an encrypted private key in PKCS#8 format.</li> </ul> <p>PEM files can also store other types of cryptographic material such as certificates (<code class="language-plaintext highlighter-rouge">-----BEGIN CERTIFICATE-----</code>).</p> <h3 id="decode-the-private-key"> <a href="#decode-the-private-key" class="anchor-heading" aria-labelledby="decode-the-private-key"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Decode the private key </h3> <p>In Makiko, the <a href="https://docs.rs/makiko/latest/makiko/keys/index.html"><code class="language-plaintext highlighter-rouge">makiko::keys</code></a> module contains functions for decoding from all these formats, both binary and PEM. For the common case of reading an unencrypted private key from PEM, you can use the function <a href="https://docs.rs/makiko/latest/makiko/keys/fn.decode_pem_privkey_nopass.html"><code class="language-plaintext highlighter-rouge">decode_pem_privkey_nopass</code></a>, which automatically detects the format of the key from the PEM tag. This function returns an enum <a href="https://docs.rs/makiko/latest/makiko/keys/enum.DecodedPrivkeyNopass.html"><code class="language-plaintext highlighter-rouge">DecodedPrivkeyNopass</code></a>, which can take one of these variants:</p> <ul> <li><code class="language-plaintext highlighter-rouge">Privkey</code> if we successfully decoded the private key.</li> <li><code class="language-plaintext highlighter-rouge">Pubkey</code> if the private key was encrypted, but we could at least decode the public key. This is supported only by the OpenSSH format.</li> <li><code class="language-plaintext highlighter-rouge">Encrypted</code> if the file was encrypted and we could not decode anything.</li> </ul> <p>We will just use the <a href="https://docs.rs/makiko/latest/makiko/keys/enum.DecodedPrivkeyNopass.html#method.privkey"><code class="language-plaintext highlighter-rouge">DecodedPrivkeyNopass::privkey()</code></a> convenience method to get the private key, if it is available. However, in a real application, we may want to prompt the user for the password if the key is encrypted.</p> <div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Decode our private key from PEM.</span>
<span class="k">let</span> <span class="n">privkey</span> <span class="o">=</span> <span class="nn">makiko</span><span class="p">::</span><span class="nn">keys</span><span class="p">::</span><span class="nf">decode_pem_privkey_nopass</span><span class="p">(</span><span class="n">PRIVKEY_PEM</span><span class="p">)</span>
    <span class="nf">.expect</span><span class="p">(</span><span class="s">"Could not decode a private key from PEM"</span><span class="p">)</span>
    <span class="nf">.privkey</span><span class="p">()</span><span class="nf">.cloned</span><span class="p">()</span>
    <span class="nf">.expect</span><span class="p">(</span><span class="s">"Private key is encrypted"</span><span class="p">);</span>
</code></pre></div></div> <p>In this tutorial, we simply hard-coded the private key, but in practice, you would usually read the key from a file or from configuration.</p> <div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">const</span> <span class="n">PRIVKEY_PEM</span><span class="p">:</span> <span class="o">&amp;</span><span class="p">[</span><span class="nb">u8</span><span class="p">]</span> <span class="o">=</span> <span class="s">br#"
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW
QyNTUxOQAAACDyVJsRfh+NmkQKg2Dh6rPVodiQ3nC+dVoGMoMtYcbMJQAAAJBPdwHAT3cB
wAAAAAtzc2gtZWQyNTUxOQAAACDyVJsRfh+NmkQKg2Dh6rPVodiQ3nC+dVoGMoMtYcbMJQ
AAAEA5ct+xfc9qlJ4I2Jee8HIrAhN55yxmtUmvKpjT7q6QXPJUmxF+H42aRAqDYOHqs9Wh
2JDecL51WgYygy1hxswlAAAABmVkd2FyZAECAwQFBgc=
-----END OPENSSH PRIVATE KEY-----
"#</span><span class="p">;</span>
</code></pre></div></div> <p class="warning">Never hard-code private keys or other credentials into your program in practice!</p> <h2 id="authenticate"> <a href="#authenticate" class="anchor-heading" aria-labelledby="authenticate"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Authenticate </h2> <p>Once we have the private key, we need to select the signing algorithm that we will use for authentication. For ECDSA and EdDSA keys, the algorithm is determined by the key type, but for RSA keys, multiple algorithms are applicable.</p> <p>The RSA algorithms differ in the hash function that is used during signing: the original algorithm <a href="https://docs.rs/makiko/latest/makiko/pubkey/static.SSH_RSA_SHA1.html">“ssh-rsa”</a> uses the SHA-1 hash algorithm, which was found to be insecure, so the protocol was extended with new algorithms that replace the hash function with SHA-2 (Makiko supports <a href="https://docs.rs/makiko/latest/makiko/pubkey/static.RSA_SHA2_256.html">“rsa-sha2-256”</a> and <a href="https://docs.rs/makiko/latest/makiko/pubkey/static.RSA_SHA2_512.html">“rsa-sha2-512”</a>). These new algorithms work with the same keys as the old “ssh-rsa” algorithm, the only difference is in the mechanism that the client uses to prove to the server that it knows the private key.</p> <p>All public key algorithms supported in Makiko are listed in the <a href="https://docs.rs/makiko/latest/makiko/pubkey/index.html#supported-algorithms"><code class="language-plaintext highlighter-rouge">makiko::pubkey</code></a> module. In this chapter, we know that the private key that we decoded in the previous section is <a href="https://docs.rs/makiko/latest/makiko/pubkey/struct.Ed25519Privkey.html">an Ed25519 key</a>, so there is just a single applicable algorithm, <a href="https://docs.rs/makiko/latest/makiko/pubkey/static.SSH_ED25519.html">“ssh-ed25519”</a>. In the next chapter, we will see how to select the algorithm more robustly.</p> <div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Select an algorithm for public key authentication.</span>
<span class="k">let</span> <span class="n">pubkey_algo</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nn">makiko</span><span class="p">::</span><span class="nn">pubkey</span><span class="p">::</span><span class="n">SSH_ED25519</span><span class="p">;</span>
</code></pre></div></div> <p>We can now call the <a href="https://docs.rs/makiko/latest/makiko/struct.Client.html#method.auth_pubkey"><code class="language-plaintext highlighter-rouge">Client::auth_pubkey()</code></a> method to authenticate with username “edward” and the private key:</p> <div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Try to authenticate with the private key</span>
<span class="k">let</span> <span class="n">auth_res</span> <span class="o">=</span> <span class="n">client</span><span class="nf">.auth_pubkey</span><span class="p">(</span><span class="s">"edward"</span><span class="nf">.into</span><span class="p">(),</span> <span class="n">privkey</span><span class="p">,</span> <span class="n">pubkey_algo</span><span class="p">)</span><span class="k">.await</span>
    <span class="nf">.expect</span><span class="p">(</span><span class="s">"Error when trying to authenticate"</span><span class="p">);</span>
</code></pre></div></div> <p>The method returns an <a href="https://docs.rs/makiko/latest/makiko/enum.AuthPubkeyResult.html"><code class="language-plaintext highlighter-rouge">AuthPubkeyResult</code></a>, which is either a <code class="language-plaintext highlighter-rouge">Success</code> or <code class="language-plaintext highlighter-rouge">Failure</code>:</p> <div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Deal with the possible outcomes of public key authentication.</span>
<span class="k">match</span> <span class="n">auth_res</span> <span class="p">{</span>
    <span class="nn">makiko</span><span class="p">::</span><span class="nn">AuthPubkeyResult</span><span class="p">::</span><span class="nb">Success</span> <span class="k">=&gt;</span> <span class="p">{</span>
        <span class="nd">println!</span><span class="p">(</span><span class="s">"We have successfully authenticated using a private key"</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="nn">makiko</span><span class="p">::</span><span class="nn">AuthPubkeyResult</span><span class="p">::</span><span class="nf">Failure</span><span class="p">(</span><span class="n">failure</span><span class="p">)</span> <span class="k">=&gt;</span> <span class="p">{</span>
        <span class="nd">panic!</span><span class="p">(</span><span class="s">"The server rejected authentication: {:?}"</span><span class="p">,</span> <span class="n">failure</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><hr /> <p>Full code for this tutorial can be found in <a href="https://github.com/honzasp/makiko/blob/master/examples/tutorial_3.rs"><code class="language-plaintext highlighter-rouge">examples/tutorial_3.rs</code></a>. The program will print a message if the authentication was successful, or an error if it failed. If you don’t use the <a href="/makiko/tutorial/1-connect.html#example-server">example server for this tutorial</a>, you may need to change the code to use a different username and private key.</p> <p> <a href="/makiko/tutorial/4-pubkey-algo.html" class="btn btn-primary">Next: Public key algorithm</a> </p> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
